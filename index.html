<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Khalid: Interactive Concept Map</title>
    <!-- Tailwind CSS (Script for styling framework) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome (Script for icons) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- YOUR CUSTOM STYLES -->
    <style>
        body {
            background-color: #fff4ef;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            color: #2d3748;
            scroll-behavior: smooth;
        }

        /* Card Styling */
        .concept-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .concept-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.1);
        }

        /* Interaction Trigger Styling */
        .interaction-trigger {
            position: relative;
        }
        
        /* Tooltip hint */
        .interaction-trigger::after {
            content: 'Click to connect';
            position: absolute;
            bottom: 5px;
            right: 10px;
            font-size: 0.6rem;
            color: #ef4444;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .interaction-trigger:hover::after {
            opacity: 1;
        }

        /* Header Colors */
        .header-risk { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); color: #991b1b; }
        .header-symptom { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); color: #92400e; }
        .header-anatomy { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: #1e40af; }
        .header-diagnosis { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: #065f46; }
        .header-patient { background: linear-gradient(135deg, #ffedd5 0%, #fed7aa 100%); color: #9a3412; }

        /* ACTIVE STATES (Triggered by JS) */
        
        /* The Cause Card (Risk) when active */
        .active-trigger {
            border-color: #ef4444 !important;
            background-color: #fff1f2 !important;
            transform: scale(1.02);
            box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.2);
        }

        /* The Effect Card (Physiology) when active */
        .active-target {
            border-color: #3b82f6 !important;
            background-color: #eff6ff !important;
            transform: scale(1.02);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        
        /* Accordion Customization */
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] > summary .chevron { transform: rotate(180deg); }
        
        /* Reveal text when active */
        .active-target .show-on-active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8" onclick="resetAll(event)">

    <!-- Header -->
    <header class="max-w-7xl mx-auto mb-8 flex flex-col md:flex-row justify-between items-center gap-4 sticky top-0 bg-[#fff4ef] z-50 py-4 shadow-sm md:shadow-none">
        <div>
            <h1 class="text-3xl font-bold text-gray-800">Mr. Khalid: Connecting the Dots</h1>
            <p class="text-gray-600 text-sm md:text-base">
                <i class="fas fa-mouse-pointer text-orange-500 mr-1"></i> 
                <strong>Click</strong> or <strong>Hover</strong> over the <span class="text-red-600 font-bold">Red Cards</span> to see the physiological link.
            </p>
        </div>
        <div class="flex gap-2 text-xs md:text-sm overflow-x-auto w-full md:w-auto pb-2 md:pb-0">
            <span class="px-3 py-1 rounded-full bg-red-100 text-red-800 font-medium whitespace-nowrap">Risk Factors</span>
            <span class="px-3 py-1 rounded-full bg-blue-100 text-blue-800 font-medium whitespace-nowrap">Physiology</span>
            <span class="px-3 py-1 rounded-full bg-yellow-100 text-yellow-800 font-medium whitespace-nowrap">Symptoms</span>
        </div>
    </header>

    <main class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6 pb-12">

        <!-- 1. PATIENT PROFILE -->
        <div class="md:col-span-3 lg:col-span-2 concept-card border-l-4 border-orange-400">
            <div class="p-6 header-patient flex justify-between items-start">
                <div>
                    <h2 class="text-2xl font-bold">Mr. Khalid</h2>
                    <p class="font-medium opacity-75">47 y/o Sales Manager</p>
                </div>
                <i class="fas fa-user-tie text-4xl opacity-50"></i>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="text-xs font-bold text-gray-400 uppercase">Chief Complaint</span>
                        <p class="font-semibold text-gray-800">Worsening Epigastric Pain</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <span class="text-xs font-bold text-gray-400 uppercase">History</span>
                        <p class="font-semibold text-gray-800">Intermittent "Burning"</p>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-orange-50 rounded border border-orange-100 text-sm text-orange-800">
                    <strong>Ethics Trigger:</strong> Employer requested medical report. <br>
                    <em>Action: Do not release without patient consent.</em>
                </div>
            </div>
        </div>

        <!-- 2. DIAGNOSIS (Expandable) -->
        <div class="md:col-span-3 lg:col-span-2 concept-card">
            <div class="p-4 header-diagnosis flex justify-between items-center">
                <h3 class="font-bold text-lg">Diagnostic Deduction</h3>
                <i class="fas fa-clipboard-check opacity-50"></i>
            </div>
            <div class="p-4 space-y-3">
                <details class="group bg-white border border-gray-100 rounded-lg p-2 transition-all open:ring-2 open:ring-green-100">
                    <summary class="flex justify-between items-center font-medium cursor-pointer text-green-700 p-1">
                        <span>Why Peptic Ulcer Disease (PUD)?</span>
                        <i class="fas fa-chevron-down chevron text-xs transition-transform duration-300"></i>
                    </summary>
                    <div class="mt-2 text-sm text-gray-600 pl-2 border-l-2 border-green-200 animate-fade-in">
                        Combines Age (47), Chronic Smoking, Stress, and the specific "Burning" pain pattern.
                    </div>
                </details>

                <details class="group bg-white border border-gray-100 rounded-lg p-2 transition-all open:ring-2 open:ring-green-100">
                    <summary class="flex justify-between items-center font-medium cursor-pointer text-green-700 p-1">
                        <span>Why Gastric Ulcer?</span>
                        <i class="fas fa-chevron-down chevron text-xs transition-transform duration-300"></i>
                    </summary>
                    <div class="mt-2 text-sm text-gray-600 pl-2 border-l-2 border-green-200 animate-fade-in">
                        <strong>The Timing is Key:</strong> Pain starts ½ - 1 hour after eating. <br>
                        <em>Duodenal Ulcers</em> are usually relieved by food and hurt hours later.
                    </div>
                </details>
            </div>
        </div>

        <!-- 3. RISK FACTORS (Interactive Triggers) -->
        <div class="md:col-span-1 lg:col-span-1 flex flex-col gap-4">
            
            <!-- Smoker Trigger -->
            <div id="trigger-defense" 
                 class="concept-card interaction-trigger group" 
                 onclick="toggleLink(event, 'defense')"
                 onmouseenter="hoverLink('defense')" 
                 onmouseleave="resetHover()">
                <div class="p-3 header-risk flex justify-between items-center">
                    <h4 class="font-bold">Chronic Smoker</h4>
                    <i class="fas fa-smoking opacity-50 group-hover:scale-110 transition-transform"></i>
                </div>
                <div class="p-3 text-sm text-gray-700">
                    <p class="mb-2">Affects blood flow.</p>
                    <p class="text-xs text-red-500 font-bold flex items-center gap-2">
                        <i class="fas fa-arrow-right"></i> Connects to Defense
                    </p>
                </div>
            </div>

            <!-- Stress Trigger -->
            <div id="trigger-motility" 
                 class="concept-card interaction-trigger group" 
                 onclick="toggleLink(event, 'motility')"
                 onmouseenter="hoverLink('motility')" 
                 onmouseleave="resetHover()">
                <div class="p-3 header-risk flex justify-between items-center">
                    <h4 class="font-bold">Job Stress</h4>
                    <i class="fas fa-briefcase opacity-50 group-hover:scale-110 transition-transform"></i>
                </div>
                <div class="p-3 text-sm text-gray-700">
                    <p class="mb-2">Sympathetic Drive ↑</p>
                    <p class="text-xs text-red-500 font-bold flex items-center gap-2">
                        <i class="fas fa-arrow-right"></i> Connects to Motility
                    </p>
                </div>
            </div>

            <!-- Diet Trigger -->
            <div id="trigger-acid" 
                 class="concept-card interaction-trigger group" 
                 onclick="toggleLink(event, 'acid')"
                 onmouseenter="hoverLink('acid')" 
                 onmouseleave="resetHover()">
                <div class="p-3 header-risk flex justify-between items-center">
                    <h4 class="font-bold">Irregular Meals</h4>
                    <i class="fas fa-coffee opacity-50 group-hover:scale-110 transition-transform"></i>
                </div>
                <div class="p-3 text-sm text-gray-700">
                    <p class="mb-2">Coffee & Fast Food.</p>
                    <p class="text-xs text-red-500 font-bold flex items-center gap-2">
                        <i class="fas fa-arrow-right"></i> Connects to Acid
                    </p>
                </div>
            </div>

             <!-- Blood Group (Static) -->
             <div class="concept-card opacity-90">
                <div class="p-3 header-risk flex justify-between items-center">
                    <h4 class="font-bold">Blood Group O+</h4>
                    <i class="fas fa-dna opacity-50"></i>
                </div>
                <div class="p-3 text-sm text-gray-700">
                    <p>Genetic risk for <em>H. pylori</em>.</p>
                </div>
            </div>
        </div>

        <!-- 4. MECHANISMS (Interactive Targets) -->
        <div class="md:col-span-1 lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4">
            
            <div class="col-span-2 concept-card">
                <div class="p-3 header-anatomy flex justify-between items-center">
                    <h3 class="font-bold">Anatomy: Epigastrium</h3>
                    <i class="fas fa-map-marker-alt opacity-50"></i>
                </div>
                <div class="p-4 text-sm space-y-2">
                     <p><strong>Contents:</strong> Stomach, Liver (Left), Duodenum, Pancreas.</p>
                     <p class="text-gray-500 italic">"Vague tenderness on deep palpation"</p>
                </div>
            </div>

            <!-- TARGET: DEFENSE -->
            <div id="target-defense" class="concept-card border-l-4 border-blue-400 transition-all duration-300">
                <div class="p-3 bg-gray-50 border-b flex justify-between items-center">
                    <h4 class="font-bold text-blue-900">Mucosal Defense</h4>
                    <i class="fas fa-shield-virus opacity-50"></i>
                </div>
                <div class="p-3 text-sm">
                    <p><strong>Normal:</strong> Mucus + Bicarb layer protects wall.</p>
                    <p class="mt-2 text-red-600 hidden show-on-active"><strong>Effect:</strong> Smoking causes ischemia, weakening this barrier.</p>
                </div>
            </div>

            <!-- TARGET: MOTILITY -->
            <div id="target-motility" class="concept-card border-l-4 border-blue-400 transition-all duration-300">
                <div class="p-3 bg-gray-50 border-b flex justify-between items-center">
                    <h4 class="font-bold text-blue-900">Motility & Acid</h4>
                    <i class="fas fa-running opacity-50"></i>
                </div>
                <div class="p-3 text-sm">
                    <p><strong>Normal:</strong> Regulated by parasympathetic.</p>
                    <p class="mt-2 text-red-600 hidden show-on-active"><strong>Effect:</strong> Stress (Sympathetic) alters motility and increases acid.</p>
                </div>
            </div>

            <!-- TARGET: ACID -->
            <div id="target-acid" class="concept-card border-l-4 border-blue-400 transition-all duration-300">
                <div class="p-3 bg-gray-50 border-b flex justify-between items-center">
                    <h4 class="font-bold text-blue-900">Acid Secretion</h4>
                    <i class="fas fa-flask opacity-50"></i>
                </div>
                <div class="p-3 text-sm">
                    <p><strong>Normal:</strong> Released during Gastric Phase.</p>
                    <p class="mt-2 text-red-600 hidden show-on-active"><strong>Effect:</strong> Coffee increases Gastrin. Irregular meals mean no buffer for acid.</p>
                </div>
            </div>

        </div>

        <!-- 5. SYMPTOMS (Results) -->
        <div class="md:col-span-1 lg:col-span-1 flex flex-col gap-4">
            <div class="concept-card">
                <div class="p-3 header-symptom flex justify-between items-center">
                    <h4 class="font-bold">"Burning" Pain</h4>
                    <i class="fas fa-fire opacity-50"></i>
                </div>
                <div class="p-3 text-sm text-gray-700">
                    Pain caused by acid hitting nerves.
                    <span class="block mt-2 font-bold text-yellow-800">½ hr post-meal</span>
                </div>
            </div>

            <div class="concept-card">
                <div class="p-3 header-symptom flex justify-between items-center">
                    <h4 class="font-bold">Weight Loss</h4>
                    <i class="fas fa-weight opacity-50"></i>
                </div>
                <div class="p-3 text-sm text-gray-700">
                    <strong>Sitophobia:</strong> Fear of eating due to pain.
                </div>
            </div>
            
            <div class="concept-card opacity-75">
                <div class="p-3 bg-gray-100 border-b">
                    <h4 class="font-bold text-xs text-gray-600 uppercase">Negative Findings</h4>
                </div>
                <ul class="p-3 text-xs text-gray-500 list-disc list-inside">
                    <li>No Anemia</li>
                    <li>No Jaundice</li>
                    <li>No Peritonism</li>
                </ul>
            </div>
        </div>

    </main>

    <!-- YOUR CUSTOM SCRIPTS -->
    <script>
        let lockedTarget = null;

        function resetAll(e) {
            // Only reset if clicking background, not a trigger
            if (!e.target.closest('.interaction-trigger')) {
                lockedTarget = null;
                document.querySelectorAll('.active-trigger').forEach(el => el.classList.remove('active-trigger'));
                document.querySelectorAll('.active-target').forEach(el => el.classList.remove('active-target'));
            }
        }

        function activate(id) {
            // Clear previous
            document.querySelectorAll('.active-trigger').forEach(el => el.classList.remove('active-trigger'));
            document.querySelectorAll('.active-target').forEach(el => el.classList.remove('active-target'));

            const trigger = document.getElementById('trigger-' + id);
            const target = document.getElementById('target-' + id);

            if (trigger && target) {
                trigger.classList.add('active-trigger');
                target.classList.add('active-target');
                
                // Scroll into view on mobile if needed
                if (window.innerWidth < 768) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        // Handle Click (Toggle)
        function toggleLink(e, id) {
            e.stopPropagation(); // Prevent body click reset
            if (lockedTarget === id) {
                // Unlock if clicking same
                lockedTarget = null;
                resetAll({ target: document.body });
            } else {
                lockedTarget = id;
                activate(id);
            }
        }

        // Handle Hover (Only if not locked by click)
        function hoverLink(id) {
            if (!lockedTarget) {
                activate(id);
            }
        }

        function resetHover() {
            if (!lockedTarget) {
                document.querySelectorAll('.active-trigger').forEach(el => el.classList.remove('active-trigger'));
                document.querySelectorAll('.active-target').forEach(el => el.classList.remove('active-target'));
            }
        }
    </script>
</body>
</html>
